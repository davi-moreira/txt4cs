<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Obtenção de conteúdo | Text as Data para Ciências Sociais</title>
  <meta name="description" content="Compilação de métodos e técnicas para análise automatizada de conteúdo" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Obtenção de conteúdo | Text as Data para Ciências Sociais" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Compilação de métodos e técnicas para análise automatizada de conteúdo" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Obtenção de conteúdo | Text as Data para Ciências Sociais" />
  
  <meta name="twitter:description" content="Compilação de métodos e técnicas para análise automatizada de conteúdo" />
  

<meta name="author" content="Davi Moreira" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stringR.html"/>
<link rel="next" href="processamento.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Text as Data para Ciências Sociais</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivo"><i class="fa fa-check"></i>Objetivo</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sobre-o-autororganizador"><i class="fa fa-check"></i>Sobre o autor/organizador</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licença"><i class="fa fa-check"></i>Licença</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimentos"><i class="fa fa-check"></i>Agradecimentos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introdução</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#o-r-e-o-rstudio"><i class="fa fa-check"></i><b>1.1</b> O <code>R</code> e o <code>RStudio</code></a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#o-pacote-txt4cs-e-outros"><i class="fa fa-check"></i><b>1.2</b> O Pacote <code>txt4cs</code> e outros</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#material-de-apoio"><i class="fa fa-check"></i><b>1.3</b> Material de apoio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#referências-para-processamento-de-sequências-de-caracteres-com-o-r"><i class="fa fa-check"></i><b>1.3.1</b> Referências para processamento de sequências de caracteres com o <code>R</code></a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#referências-em-análise-de-conteúdo-com-o-r"><i class="fa fa-check"></i><b>1.3.2</b> Referências em análise de conteúdo com o <code>R</code>:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tada.html"><a href="tada.html"><i class="fa fa-check"></i><b>2</b> Text as data: o texto como dado</a><ul>
<li class="chapter" data-level="2.1" data-path="tada.html"><a href="tada.html#panorama-da-área"><i class="fa fa-check"></i><b>2.1</b> Panorama da área</a></li>
<li class="chapter" data-level="2.2" data-path="tada.html"><a href="tada.html#oportunidades"><i class="fa fa-check"></i><b>2.2</b> Oportunidades</a></li>
<li class="chapter" data-level="2.3" data-path="tada.html"><a href="tada.html#quadro-geral-de-metodologias"><i class="fa fa-check"></i><b>2.3</b> Quadro geral de metodologias</a></li>
<li class="chapter" data-level="2.4" data-path="tada.html"><a href="tada.html#o-processo-de-análise-do-texto-como-dado"><i class="fa fa-check"></i><b>2.4</b> O processo de análise do texto como dado</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regex.html"><a href="regex.html"><i class="fa fa-check"></i><b>3</b> R e o Processamento de Linguagem Natural</a><ul>
<li class="chapter" data-level="3.1" data-path="regex.html"><a href="regex.html#encoding---codificação-de-caracteres"><i class="fa fa-check"></i><b>3.1</b> Encoding - Codificação de caracteres</a></li>
<li class="chapter" data-level="3.2" data-path="regex.html"><a href="regex.html#encoding-para-remover-acentos"><i class="fa fa-check"></i><b>3.2</b> Encoding para remover acentos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stringR.html"><a href="stringR.html"><i class="fa fa-check"></i><b>4</b> Strings no <code>R</code></a><ul>
<li class="chapter" data-level="4.1" data-path="stringR.html"><a href="stringR.html#strings-e-vetores"><i class="fa fa-check"></i><b>4.1</b> Strings e vetores</a><ul>
<li class="chapter" data-level="4.1.1" data-path="stringR.html"><a href="stringR.html#o-r-é-case-sensitive"><i class="fa fa-check"></i><b>4.1.1</b> O <code>R</code> é case sensitive</a></li>
<li class="chapter" data-level="4.1.2" data-path="stringR.html"><a href="stringR.html#sequências-de-caracteres"><i class="fa fa-check"></i><b>4.1.2</b> Sequências de caracteres</a></li>
<li class="chapter" data-level="4.1.3" data-path="stringR.html"><a href="stringR.html#operações-básicas-com-vetores-de-strings"><i class="fa fa-check"></i><b>4.1.3</b> Operações básicas com vetores de strings</a></li>
<li class="chapter" data-level="4.1.4" data-path="stringR.html"><a href="stringR.html#caracteres-e-outros-tipos-de-dados"><i class="fa fa-check"></i><b>4.1.4</b> Caracteres e outros tipos de dados</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="stringR.html"><a href="stringR.html#strings-e-matrizes"><i class="fa fa-check"></i><b>4.2</b> Strings e matrizes</a></li>
<li class="chapter" data-level="4.3" data-path="stringR.html"><a href="stringR.html#strings-e-data.frames"><i class="fa fa-check"></i><b>4.3</b> Strings e data.frames</a></li>
<li class="chapter" data-level="4.4" data-path="stringR.html"><a href="stringR.html#strings-e-listas"><i class="fa fa-check"></i><b>4.4</b> Strings e listas</a></li>
<li class="chapter" data-level="4.5" data-path="stringR.html"><a href="stringR.html#processamento-básico"><i class="fa fa-check"></i><b>4.5</b> Processamento básico</a><ul>
<li class="chapter" data-level="4.5.1" data-path="stringR.html"><a href="stringR.html#contando-caracteres"><i class="fa fa-check"></i><b>4.5.1</b> Contando caracteres</a></li>
<li class="chapter" data-level="4.5.2" data-path="stringR.html"><a href="stringR.html#toupper-tolower"><i class="fa fa-check"></i><b>4.5.2</b> <code>toupper()</code>, <code>tolower()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="stringR.html"><a href="stringR.html#o-pacote-stringr"><i class="fa fa-check"></i><b>4.6</b> O pacote <code>stringr</code></a><ul>
<li class="chapter" data-level="4.6.1" data-path="stringR.html"><a href="stringR.html#verificando-o-tamanho-de-uma-string"><i class="fa fa-check"></i><b>4.6.1</b> Verificando o tamanho de uma string</a></li>
<li class="chapter" data-level="4.6.2" data-path="stringR.html"><a href="stringR.html#identificando-caracter-numa-posição-específica."><i class="fa fa-check"></i><b>4.6.2</b> Identificando caracter numa posição específica.</a></li>
<li class="chapter" data-level="4.6.3" data-path="stringR.html"><a href="stringR.html#incluindo-caracter-ou-string-numa-posicao-específica."><i class="fa fa-check"></i><b>4.6.3</b> Incluindo caracter ou string numa posicao específica.</a></li>
<li class="chapter" data-level="4.6.4" data-path="stringR.html"><a href="stringR.html#recortando-uma-string-para-obter-parte-da-sequência-de-caracteres."><i class="fa fa-check"></i><b>4.6.4</b> Recortando uma string para obter parte da sequência de caracteres.</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="stringR.html"><a href="stringR.html#regular-expressions-no-r"><i class="fa fa-check"></i><b>4.7</b> Regular Expressions no <code>R</code></a><ul>
<li class="chapter" data-level="4.7.1" data-path="stringR.html"><a href="stringR.html#identificação-e-extração-de-padrão"><i class="fa fa-check"></i><b>4.7.1</b> Identificação e Extração de padrão</a></li>
<li class="chapter" data-level="4.7.2" data-path="stringR.html"><a href="stringR.html#substituição"><i class="fa fa-check"></i><b>4.7.2</b> Substituição</a></li>
<li class="chapter" data-level="4.7.3" data-path="stringR.html"><a href="stringR.html#âncoras"><i class="fa fa-check"></i><b>4.7.3</b> Âncoras</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scrape.html"><a href="scrape.html"><i class="fa fa-check"></i><b>5</b> Obtenção de conteúdo</a><ul>
<li class="chapter" data-level="5.1" data-path="scrape.html"><a href="scrape.html#word-excel-ou-.pdf"><i class="fa fa-check"></i><b>5.1</b> word, excel ou <code>.pdf</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="scrape.html"><a href="scrape.html#xlsx"><i class="fa fa-check"></i><b>5.1.1</b> <code>.xlsx</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="scrape.html"><a href="scrape.html#pdf-e-.doc"><i class="fa fa-check"></i><b>5.1.2</b> <code>.pdf</code> e <code id="pdf">.doc</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="scrape.html"><a href="scrape.html#webscraping"><i class="fa fa-check"></i><b>5.2</b> Webscraping</a><ul>
<li class="chapter" data-level="5.2.1" data-path="scrape.html"><a href="scrape.html#pacotes-para-raspagem-de-dados"><i class="fa fa-check"></i><b>5.2.1</b> Pacotes para raspagem de dados</a></li>
<li class="chapter" data-level="5.2.2" data-path="scrape.html"><a href="scrape.html#etapas-para-raspagem-de-dados-na-web"><i class="fa fa-check"></i><b>5.2.2</b> Etapas para raspagem de dados na web</a></li>
<li class="chapter" data-level="5.2.3" data-path="scrape.html"><a href="scrape.html#código-fonte"><i class="fa fa-check"></i><b>5.2.3</b> Código fonte</a></li>
<li class="chapter" data-level="5.2.4" data-path="scrape.html"><a href="scrape.html#obtenção-de-código-fonte---exemplo"><i class="fa fa-check"></i><b>5.2.4</b> Obtenção de Código Fonte - Exemplo:</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="scrape.html"><a href="scrape.html#web-services"><i class="fa fa-check"></i><b>5.3</b> Web Services</a><ul>
<li class="chapter" data-level="5.3.1" data-path="scrape.html"><a href="scrape.html#obtenção-de-conteúdo-via-ws---exemplo"><i class="fa fa-check"></i><b>5.3.1</b> Obtenção de conteúdo via WS - Exemplo:</a></li>
<li class="chapter" data-level="5.3.2" data-path="scrape.html"><a href="scrape.html#a-obter-os-meta-dados-dos-discursos"><i class="fa fa-check"></i><b>5.3.2</b> a) obter os meta-dados dos discursos</a></li>
<li class="chapter" data-level="5.3.3" data-path="scrape.html"><a href="scrape.html#b-obter-o-conteúdo-dos-discursos-inteiror-teor."><i class="fa fa-check"></i><b>5.3.3</b> b) obter o conteúdo dos discursos (inteiror teor).**</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="scrape.html"><a href="scrape.html#download-de-arquivos-da-web"><i class="fa fa-check"></i><b>5.4</b> Download de arquivos da web</a></li>
<li class="chapter" data-level="5.5" data-path="scrape.html"><a href="scrape.html#twitter"><i class="fa fa-check"></i><b>5.5</b> Twitter</a></li>
<li class="chapter" data-level="5.6" data-path="scrape.html"><a href="scrape.html#imagens"><i class="fa fa-check"></i><b>5.6</b> Imagens</a></li>
<li class="chapter" data-level="5.7" data-path="scrape.html"><a href="scrape.html#áudio-transcrição"><i class="fa fa-check"></i><b>5.7</b> Áudio Transcrição</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="processamento.html"><a href="processamento.html"><i class="fa fa-check"></i><b>6</b> Processamento dos dados</a><ul>
<li class="chapter" data-level="6.1" data-path="processamento.html"><a href="processamento.html#tokens"><i class="fa fa-check"></i><b>6.1</b> Tokens</a></li>
<li class="chapter" data-level="6.2" data-path="processamento.html"><a href="processamento.html#corpus"><i class="fa fa-check"></i><b>6.2</b> Corpus</a></li>
<li class="chapter" data-level="6.3" data-path="processamento.html"><a href="processamento.html#tokens-e-corpus"><i class="fa fa-check"></i><b>6.3</b> Tokens e Corpus</a></li>
<li class="chapter" data-level="6.4" data-path="processamento.html"><a href="processamento.html#dfm-matriz-de-documentos-e-termos"><i class="fa fa-check"></i><b>6.4</b> DFM: Matriz de documentos e termos</a></li>
<li class="chapter" data-level="6.5" data-path="processamento.html"><a href="processamento.html#stemming"><i class="fa fa-check"></i><b>6.5</b> Stemming</a></li>
<li class="chapter" data-level="6.6" data-path="processamento.html"><a href="processamento.html#fcm-matriz-de-co-ocorrência-de-termos"><i class="fa fa-check"></i><b>6.6</b> FCM: Matriz de co-ocorrência de termos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stat.html"><a href="stat.html"><i class="fa fa-check"></i><b>7</b> Mineração e estatísticas básicas</a><ul>
<li class="chapter" data-level="7.1" data-path="stat.html"><a href="stat.html#análise-de-frequência"><i class="fa fa-check"></i><b>7.1</b> Análise de frequência</a></li>
<li class="chapter" data-level="7.2" data-path="stat.html"><a href="stat.html#nuvem-de-palavras"><i class="fa fa-check"></i><b>7.2</b> Nuvem de palavras</a></li>
<li class="chapter" data-level="7.3" data-path="stat.html"><a href="stat.html#tf-idf"><i class="fa fa-check"></i><b>7.3</b> tf-idf</a></li>
<li class="chapter" data-level="7.4" data-path="stat.html"><a href="stat.html#rede-de-n-grams"><i class="fa fa-check"></i><b>7.4</b> Rede de n-grams</a></li>
<li class="chapter" data-level="7.5" data-path="stat.html"><a href="stat.html#correlação-pareada"><i class="fa fa-check"></i><b>7.5</b> Correlação pareada</a></li>
<li class="chapter" data-level="7.6" data-path="stat.html"><a href="stat.html#diversidade-lexical"><i class="fa fa-check"></i><b>7.6</b> Diversidade lexical</a></li>
<li class="chapter" data-level="7.7" data-path="stat.html"><a href="stat.html#similaridade-entre-documentostermos"><i class="fa fa-check"></i><b>7.7</b> Similaridade entre documentos/termos</a></li>
<li class="chapter" data-level="7.8" data-path="stat.html"><a href="stat.html#keyness-análise-de-frequência-relativa"><i class="fa fa-check"></i><b>7.8</b> KEYNESS: Análise de Frequência Relativa</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="scalling.html"><a href="scalling.html"><i class="fa fa-check"></i><b>8</b> Escalonamento</a><ul>
<li class="chapter" data-level="8.1" data-path="scalling.html"><a href="scalling.html#wordscore"><i class="fa fa-check"></i><b>8.1</b> Wordscore</a></li>
<li class="chapter" data-level="8.2" data-path="scalling.html"><a href="scalling.html#wordfish"><i class="fa fa-check"></i><b>8.2</b> Wordfish</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="classificacao.html"><a href="classificacao.html"><i class="fa fa-check"></i><b>9</b> Classificação</a><ul>
<li class="chapter" data-level="9.1" data-path="classificacao.html"><a href="classificacao.html#método-de-dicionário-análise-de-sentimento"><i class="fa fa-check"></i><b>9.1</b> Método de dicionário: Análise de sentimento</a></li>
<li class="chapter" data-level="9.2" data-path="classificacao.html"><a href="classificacao.html#naive-bayes"><i class="fa fa-check"></i><b>9.2</b> Naive Bayes</a></li>
<li class="chapter" data-level="9.3" data-path="classificacao.html"><a href="classificacao.html#lda-latent-dirichlet-allocation"><i class="fa fa-check"></i><b>9.3</b> LDA: Latent Dirichlet Allocation</a></li>
<li class="chapter" data-level="9.4" data-path="classificacao.html"><a href="classificacao.html#stm-structed-topic-model"><i class="fa fa-check"></i><b>9.4</b> STM: Structed Topic Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referências.html"><a href="referências.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Text as Data</em> para Ciências Sociais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scrape" class="section level1">
<h1><span class="header-section-number">Capítulo 5</span> Obtenção de conteúdo</h1>
<!--- preview_chapter("05-obtencao-conteudo.Rmd") --->
<p>Uma das tarefas mais importantes para a análise de conteúdo consiste na sua própria
busca e aquisição. O <code>R</code> nos ajuda nessa tarefa a partir de distintas estratégias.
A seguir apresento aquelas nas quais o uso de técnicas computacionais e programação
potencializa o alcance e escala de acervos a serem utilizados para pesquisas.</p>
<div id="word-excel-ou-.pdf" class="section level2">
<h2><span class="header-section-number">5.1</span> word, excel ou <code>.pdf</code></h2>
<p>Caso tenha realizado surveys com perguntas abertas ou possua conteúdo de texto
organizado em formato de documento ou tabulado é possível utilizar o <code>R</code> para
analisá-las. Para arquivos em formato excel pode-se usar o pacote <code>readxl</code> com a
função <code>read_excel</code>, funciona de forma similar ao exemplo em de leitura de arquivos
em <code>.csv</code>. Para leitura de arquivos <code>.txt</code>, <code>.csv</code>, entre outros, recomenda-se
utilizar o pacote <code>readr</code>. Vejamos um exemplo:</p>
<div id="xlsx" class="section level3">
<h3><span class="header-section-number">5.1.1</span> <code>.xlsx</code></h3>
<center>
<div class="figure">
<img src="images/SPLegisRelatorios.jpg" alt="SPLegis" width="700" />
<p class="caption">SPLegis</p>
</div>
</center>
<p>A Câmara dos Vereadores de São Paulo publica dados de sua atividade no portal
<a href="http://app-splegisreport-prd.azurewebsites.net/default.aspx">SPLegis</a>. Entre as
informações disponíveis, é possível obter <a href="http://app-splegisreport-prd.azurewebsites.net/Report/VIEW_REL_EMENDA/List.aspx">relatórios dos projetos</a>
com o conteúdo de todas as ementas através do download de um arquivo em formato <code>.xlsx</code>!</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">arquivo_excel &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Emendas Apresentadas.xlsx&quot;</span>)</a></code></pre></div>
</div>
<div id="pdf-e-.doc" class="section level3">
<h3><span class="header-section-number">5.1.2</span> <code>.pdf</code> e <code id="pdf">.doc</code></h3>
<p>Antes de achar que os dados de um arquivo <code>.pdf</code> ou <code>.doc</code> são um obstáculo para
a abordagem do texto como dado, diferentes estratégias podem ser adotadas para sua
obtenção e processamento. Com o uso do pacote <code>textreadr</code>, por exemplo, de forma
simples pode-se transformar o conteúdo do arquivo <code>.pdf</code> num arquivo <code>.txt</code>. Vejamos o
conteúdo do <a href="http://www.biblioteca.presidencia.gov.br/presidencia/ex-presidentes/luiz-inacio-lula-da-silva/discursos/1o-mandato/2003/01-01-pronunciamento-a-nacao-do-presidente-da-republica-luiz-inacio-lula-da-silva-apos-a-cerimonia-de-posse.pdf/view">discurso de posse do ex-presidente Luis Inácio Lula da Silva realizado em
01 de janeiro de 2003 no Congresso Nacional</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(textreadr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># lendo arquivo .pdf</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">txt &lt;-<span class="st"> </span><span class="kw">read_document</span>(<span class="st">&quot;https://raw.githubusercontent.com/davi-moreira/txt4cs/master/data/lula-pronunciamento-posse-cd-2003.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># salvando como .txt</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">writeLines</span>(txt, <span class="st">&quot;lula-pronunciamento-posse-cd-2003.txt&quot;</span>)</a></code></pre></div>
<!--- BRAPRSpeech --->
</div>
</div>
<div id="webscraping" class="section level2">
<h2><span class="header-section-number">5.2</span> Webscraping</h2>
<p>O <em>Webscraping</em> consiste na possibilidade de uso de programação para raspagem de
dados da web, ou seja a obtenção de conteúdo presente na web. Nesse sentido, suponha
que ao invés de montar uma equipe que irá acessar páginas na web para coletar seu
conteúdo, você desenvolverá um programa específico para realizar essa tarefa com
foco sobre os objetivos de sua pesquisa.</p>
<div id="pacotes-para-raspagem-de-dados" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Pacotes para raspagem de dados</h3>
<p>Há diversos pacotes para raspagem de dados com o <code>R</code>. Abaixo segue um lista com os
principais. Para referências sobre seu uso, consulte os links indicados,
<a href="https://www.datacamp.com/community/tutorials/r-web-scraping-rvest">este tutorial sobre o <code>rvest</code></a> e
<a href="http://material.curso-r.com/scrape/">este capitulo sobre web scraping</a>.</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/httr/vignettes/quickstart.html"><code>httr</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/xml2/xml2.pdf"><code>xml2</code></a></li>
<li><a href="https://blog.rstudio.com/2014/11/24/rvest-easy-web-scraping-with-r/"><code>rvest</code></a></li>
</ul>
<p>Como o site <a href="http://material.curso-r.com/scrape/">Curso-R</a> destaca, esses pacotes
não são suficientes para acessar todo tipo de conteúdo da web. Páginas com conteúdo
produzido na linguagem <code>javascript</code>, por exemplo, precisam de outras ferramentas para
acesso a seu conteúdo. Nesses casos, é necessário “simular” um navegador que acessa
a página web e realiza consultas. Uma das melhores ferramentas para isso é o
<code>selenium</code>, abaixo indicado.</p>
<ul>
<li><a href="https://ropensci.org/tutorials/rselenium_tutorial/"><code>RSelenium</code></a></li>
</ul>
</div>
<div id="etapas-para-raspagem-de-dados-na-web" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Etapas para raspagem de dados na web</h3>
<p>O processo de raspagem dos dados consiste nas seguintes etapas:</p>
<ul>
<li><strong>Etapa 1:</strong> Conhecer detalhadamente o caminho para acesso aos dados
<ul>
<li>Qual o caminho que um usuário necessita realizar para obter os dados?</li>
<li>É necessário preencher um formulário ou assinalar um Recapctha?</li>
</ul></li>
<li><strong>Etapa 2:</strong> Armazenar todos os caminhos de acesso aos dados de forma amigável ao programa
<ul>
<li>Caso exista um caminho para obter esse dado, deve ser registrado</li>
<li>Não é necessário realizar esse procedimento em todos as páginas que for realizar, mas é desejável.</li>
</ul></li>
<li><p><strong>Etapa 3:</strong> Obter os dados: raspagem de fato</p></li>
<li><p><strong>Etapa 4:</strong> Processar os dados obtidos</p></li>
</ul>
</div>
<div id="código-fonte" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Código fonte</h3>
<p>Toda página na internet possui um código-fonte - muitas vezes em <code>html</code> - que indica
e cria o conteúdo de forma visual para página. Ao clicar na página desejada com o
botão direito do mouse e selecionar “código fonte” ou digitar <code>CRTL + U</code>, pode-se
visualizá-lo. Vejamos um exemplo:</p>
<center>
<div class="figure">
<img src="images/deputados.png" alt="Câmara dos Deputados" width="700" />
<p class="caption">Câmara dos Deputados</p>
</div>
</center>
<!--- o codigo abaixo permite deixar uma pagina embeded no livro --->
<p>Ao acessar o código fonte dessa <a href="https://www.camara.leg.br/internet/SitaqWeb/TextoHTML.asp?etapa=5&amp;nuSessao=174.4.53.O&amp;nuQuarto=56&amp;nuOrador=2&amp;nuInsercao=0&amp;dtHorarioQuarto=11:46&amp;sgFaseSessao=BC&amp;Data=17/08/2010&amp;txApelido=JAIR%20BOLSONARO,%20PP-RJ&amp;txFaseSessao=Breves%20Comunica%C3%A7%C3%B5es&amp;txTipoSessao=Extraordin%C3%A1ria%20-%20CD&amp;dtHoraQuarto=11:46&amp;txEtapa=">página do portal da Câmara dos Deputados</a>, você consegue visualizar o código <code>.html</code> que produz toda visualização,
incluindo o conteúdo do discurso proferido pelo então deputado Jair Bolsonaro em 17 de Agosto de 2010<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
</div>
<div id="obtenção-de-código-fonte---exemplo" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Obtenção de Código Fonte - Exemplo:</h3>
<p>Se é possível visualizar o conteúdo, é possível obtê-lo de forma automatizada. Vamos, portanto,
obter <a href="https://www.camara.leg.br/internet/SitaqWeb/TextoHTML.asp?etapa=5&amp;nuSessao=174.4.53.O&amp;nuQuarto=56&amp;nuOrador=2&amp;nuInsercao=0&amp;dtHorarioQuarto=11:46&amp;sgFaseSessao=BC&amp;Data=17/08/2010&amp;txApelido=JAIR%20BOLSONARO,%20PP-RJ&amp;txFaseSessao=Breves%20Comunica%C3%A7%C3%B5es&amp;txTipoSessao=Extraordin%C3%A1ria%20-%20CD&amp;dtHoraQuarto=11:46&amp;txEtapa=">o conteúdo do discurso proferido pelo então deputado Jair Bolsonaro</a> em 17 de Agosto de 2010<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<p>Vamos utilizar as Etapas anteriormente apresentadas:</p>
<p>De uma só vez, conseguimos cumprir as Etapas 1 e 2 com o código abaixo:</p>
<p><strong>Etapa 1: Conhecer detalhadamente o caminho para acesso aos dados:</strong> no nosso exemplo, o código
fonte do endereço virtual que apresenta o discurso também nos apresenta o conteúdo publicado.</p>
<p><strong>Etapa 2: Armazenar todos os caminhos de acesso aos dados de forma amigável ao programa:</strong> nesse exemplo,
trata-se de apenas um endereço que armazenamos no objeto <code>link</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># carregando pacotes ----</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">library</span>(rvest)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">library</span>(httr)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># definindo o endereço da web</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">link &lt;-<span class="st"> &quot;https://www.camara.leg.br/internet/SitaqWeb/TextoHTML.asp?etapa=5&amp;nuSessao=174.4.53.O&amp;nuQuarto=56&amp;nuOrador=2&amp;nuInsercao=0&amp;dtHorarioQuarto=11:46&amp;sgFaseSessao=BC&amp;Data=17/08/2010&amp;txApelido=JAIR%20BOLSONARO,%20PP-RJ&amp;txFaseSessao=Breves%20Comunica%C3%A7%C3%B5es&amp;txTipoSessao=Extraordin%C3%A1ria%20-%20CD&amp;dtHoraQuarto=11:46&amp;txEtapa=&quot;</span></a></code></pre></div>
<p><strong>Etapa 3: Obter os dados:</strong> Podemos facilmente obter o código fonte de um endereço
na internet com o uso da função <code>readLines</code>. Aplicamos, portanto, a função no
objeto <code>link</code> e atribuímos seu resultado ao objeto <code>conteudo</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># obtem o codigo fonte</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">conteudo &lt;-<span class="st"> </span><span class="kw">readLines</span>(link)  </a></code></pre></div>
<p>Veja que o objeto <code>conteudo</code> é um vetor cujos elementos são cada uma das linhas
presentes no código fonte da página. Isso significa que não precisamos mais do
acesso à internet ou do próprio endereço para processar o conteúdo obtido uma vez
que já está retido no seu ambiente de trabalho no <code>R</code>. Nessa etapa, pode ser
conveniente salvar o objeto <code>conteudo</code> em seu formato bruto para posterior
tratamento.</p>
<p><strong>Etapa 4: Processar os dados obtidos:</strong></p>
<p>Para finalizar nossa tarefa, uma rápida análise do objeto <code>conteudo</code> (código fonte
da página que publicou o discurso), nos mostra que o elemento <code>328</code> do vetor apresenta
o conteúdo de interesse. Veja que, nesse caso, a análise do próprio código fonte da
página da Câmara dos Deputados apresenta o conteúdo do discurso na linha 328 do código <code>html</code>.</p>
<p>Para processar os dados obtidos, vamos selecionar apenas o elemento 328 e assim concluímos nossa missão.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">conteudo &lt;-<span class="st"> </span>conteudo[<span class="dv">328</span>]</a></code></pre></div>
<div id="atividade-prática" class="section level4">
<h4><span class="header-section-number">5.2.4.1</span> Atividade prática</h4>
<p>Com base no exemplo acima, obtenha o código fonte da página do <a href="https://pt.wikipedia.org/wiki/Chico_Buarque">Chico Buarque na Wikipédia</a>.</p>
</div>
</div>
</div>
<div id="web-services" class="section level2">
<h2><span class="header-section-number">5.3</span> Web Services</h2>
<p>Os <a href="https://pt.wikipedia.org/wiki/Web_service">Web services</a> são utilizados para
disponibilizar serviços interativos na Web, podendo ser acessados por outras
aplicações. O objetivo dos Web Services é a comunicação de aplicações através da Internet.
Um dos motivos que tornam os Web Services atrativos para a obtenção de dados e conteúdo é
o fato deste serviço ser desenvolvido com base em tecnologias <em>standards</em>, em particular
<code>XML</code> e <code>HTTP</code> (Hypertext Transfer Protocol).</p>
<div id="obtenção-de-conteúdo-via-ws---exemplo" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Obtenção de conteúdo via WS - Exemplo:</h3>
<p>A Câmara dos Deputados do Brasil possui um excelente serviço de transparência.
Estimulado pela iniciativa do <a href="http://labhackercd.leg.br/">Laboratório Hacker</a>, foi desenvolvido
o <a href="http://www2.camara.leg.br/transparencia/dados-abertos/dados-abertos-legislativo/webservices">Web service da Câmara dos Deputados</a>.</p>
<p>Após a realização da Primeira Maratona Hacker da Câmara dos Deputados em 2013, quando fora
desenvolvido o <a href="http://retorica.labhackercd.leg.br/">Projeto Retórica Parlamentar</a>, o Web Service
da CD passou a disponibilizar os discursos proferidos pelos deputados federais em plenário.</p>
<center>
<div class="figure">
<img src="images/september-11th.png" alt="September 11th - The Washington Post" width="400" />
<p class="caption">September 11th - The Washington Post</p>
</div>
</center>
<p>Os <a href="https://pt.wikipedia.org/wiki/Ataques_de_11_de_setembro_de_2001">ataques terroistas de 11 de setembro de 2001</a>
chocaram o mundo e os deputados federais brasileiros não ficaram em silêncio diante de
fato tão relevante. Nossa tarefa será a de obter os dados e o conteúdo dos discursos proferidos nesse dia terrível.
Em virtude da estrutura de disponibilização dos dados no WebService da Câmara dos Deputados, nossa tarefa será dividida em duas subtarefas:</p>
<ol style="list-style-type: lower-alpha">
<li>obter os meta-dados dos discursos;</li>
<li>obter o conteúdo dos discursos (inteiror teor).</li>
</ol>
<!--- BRAParlSpeech --->
</div>
<div id="a-obter-os-meta-dados-dos-discursos" class="section level3">
<h3><span class="header-section-number">5.3.2</span> a) obter os meta-dados dos discursos</h3>
<p>Vamos utilizar as Etapas anteriormente apresentadas:</p>
<p>De uma só vez, conseguimos realizar as Etapas 1 e 2:</p>
<p><strong>Etapa 1: Conhecer detalhadamente o caminho para acesso aos dados:</strong></p>
<p>Conhecendo exatamente como deve ser a chamada (o endereço que dá acesso aos dados),
podemos simplesmente passar os parâmetros. Os parâmetros podem ser encontrados no guia do <a href="https://www2.camara.leg.br/transparencia/dados-abertos/dados-abertos-legislativo/webservices/sessoesreunioes-2/listardiscursosplenario">WebService</a>.
No nosso exemplo, temos como parâmetros a data inicial (<code>dataInicial</code>) e a data
final (<code>dataFinal</code>) de busca pelos discursos. Sendo nosso objetivo obter os
discursos proferidos num mesmo dia, usamos como parâmetros “11/09/2001”.</p>
<p><strong>Etapa 2: Armazenar todos os caminhos de acesso aos dados de forma amigável ao programa:</strong></p>
<p>Nesse exemplo, trata-se de apenas um endereço que armazenamos no objeto <code>link</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># pacotes </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">library</span>(httr)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">library</span>(XML)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw">library</span>(RCurl)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># definindo parametros da chamada</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">dataInicial &lt;-<span class="st"> &quot;11/09/2001&quot;</span> </a>
<a class="sourceLine" id="cb6-11" data-line-number="11">dataFinal &lt;-<span class="st"> &quot;11/09/2001&quot;</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co"># alocando enderenço a objeto link</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">link &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;https://www.camara.leg.br/sitcamaraws/SessoesReunioes.asmx/ListarDiscursosPlenario?&quot;</span>,</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">                <span class="st">&quot;dataIni=&quot;</span>, dataInicial,</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">                <span class="st">&quot;&amp;dataFim=&quot;</span>, dataFinal, </a>
<a class="sourceLine" id="cb6-17" data-line-number="17">                <span class="st">&quot;&amp;codigoSessao=&amp;parteNomeParlamentar=&amp;siglaPartido=&amp;siglaUF=&quot;</span>,</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">                <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><strong>Etapa 3: Obter os dados:</strong></p>
<p>Para essa etapa, basta fazer uso da função <code>GET</code>. No código abaixo, armazenamos os resultados no objeto <code>response</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">response &lt;-<span class="st"> </span><span class="kw">GET</span>(link)</a></code></pre></div>
<p><strong>Etapa 4: Processar os dados obtidos:</strong></p>
<p>Organizar o resultado da função <code>GET</code> num formato de matriz de dados (<code>data.frame</code>) é
simples. Primeiro, transformamos o resultado numa lista, na qual cada elemento será
uma das sessões legislativas realizadas naquela data. Em segundo lugar, de forma
interativa, usando a função <code>for</code>, alocamos os campos desejados num objeto <code>data.frame</code><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># analisa um arquivo XML ou HTML e gera uma estrutura no R.</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">data &lt;-<span class="st"> </span><span class="kw">xmlParse</span>(response, <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) </a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># transforma um XML nó em lista. Importante pois permite você reconhecer o caminho para obtenção dos dados. Exemplo: &quot;$sessao$fasesSessao$faseSessao$discursos$discurso$sumario&quot;</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">ls &lt;-<span class="st"> </span><span class="kw">xmlToList</span>(data) </a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co"># data frame que recebera dados dos pronunciamentos</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">bd &lt;-<span class="st"> </span><span class="kw">data.frame</span>()  </a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ls)){</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">    <span class="co"># obtendo quantidade de pronunciamentos de uma respectiva sessao</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12">    quantPronunciamentos &lt;-<span class="st"> </span><span class="kw">length</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos)</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb8-14" data-line-number="14">    sumario &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">    numInsercao &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-16" data-line-number="16">    numQuarto &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-17" data-line-number="17">    indexacao &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-18" data-line-number="18">    hora &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-19" data-line-number="19">    uf &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">    numOrador &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-21" data-line-number="21">    nomeOrador &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-22" data-line-number="22">    partido &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;character&quot;</span>)</a>
<a class="sourceLine" id="cb8-23" data-line-number="23">    </a>
<a class="sourceLine" id="cb8-24" data-line-number="24">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>quantPronunciamentos){</a>
<a class="sourceLine" id="cb8-25" data-line-number="25">      <span class="co"># obtendo todos os dados do pronunciamento</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26">      <span class="co"># sumario</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27">      sumario[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>sumario)</a>
<a class="sourceLine" id="cb8-29" data-line-number="29">      <span class="co"># insercao</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30">      numInsercao[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>numeroInsercao)</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">      <span class="co"># quarto</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33">      numQuarto[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>numeroQuarto)</a>
<a class="sourceLine" id="cb8-35" data-line-number="35">      <span class="co"># indexacao</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36">      indexacao[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>txtIndexacao)</a>
<a class="sourceLine" id="cb8-38" data-line-number="38">      <span class="co"># hora</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39">      hora[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>horaInicioDiscurso)</a>
<a class="sourceLine" id="cb8-41" data-line-number="41">      <span class="co"># uf orador</span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42">      uf[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>orador<span class="op">$</span>uf)</a>
<a class="sourceLine" id="cb8-44" data-line-number="44">      <span class="co"># numero orador</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45">      numOrador[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>orador<span class="op">$</span>numero)</a>
<a class="sourceLine" id="cb8-47" data-line-number="47">      <span class="co"># nome orador</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48">      nomeOrador[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-49" data-line-number="49"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>orador<span class="op">$</span>nome)</a>
<a class="sourceLine" id="cb8-50" data-line-number="50">      <span class="co"># partido orador</span></a>
<a class="sourceLine" id="cb8-51" data-line-number="51">      partido[j] &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-52" data-line-number="52"><span class="st">        </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>discursos[[j]]<span class="op">$</span>orador<span class="op">$</span>partido)</a>
<a class="sourceLine" id="cb8-53" data-line-number="53">    }</a>
<a class="sourceLine" id="cb8-54" data-line-number="54">    </a>
<a class="sourceLine" id="cb8-55" data-line-number="55">    <span class="co"># obtendo todos os dados da fase</span></a>
<a class="sourceLine" id="cb8-56" data-line-number="56">    <span class="co"># codigo</span></a>
<a class="sourceLine" id="cb8-57" data-line-number="57">    codigoFase &lt;-<span class="st"> </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>codigo)</a>
<a class="sourceLine" id="cb8-58" data-line-number="58">    <span class="co"># descricao</span></a>
<a class="sourceLine" id="cb8-59" data-line-number="59">    descricaoFase &lt;-<span class="st"> </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>fasesSessao<span class="op">$</span>faseSessao<span class="op">$</span>descricao)</a>
<a class="sourceLine" id="cb8-60" data-line-number="60">    <span class="co"># obtendo todos os dados da sessao</span></a>
<a class="sourceLine" id="cb8-61" data-line-number="61">    <span class="co"># codigo</span></a>
<a class="sourceLine" id="cb8-62" data-line-number="62">    codigoSessao &lt;-<span class="st"> </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>codigo)</a>
<a class="sourceLine" id="cb8-63" data-line-number="63">    <span class="co"># data</span></a>
<a class="sourceLine" id="cb8-64" data-line-number="64">    dataSessao &lt;-<span class="st"> </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb8-65" data-line-number="65">    <span class="co"># numero</span></a>
<a class="sourceLine" id="cb8-66" data-line-number="66">    numSessao &lt;-<span class="st"> </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>numero)</a>
<a class="sourceLine" id="cb8-67" data-line-number="67">    <span class="co"># tipo</span></a>
<a class="sourceLine" id="cb8-68" data-line-number="68">    tipoSessao &lt;-<span class="st"> </span><span class="kw">str_trim</span>(ls[i]<span class="op">$</span>sessao<span class="op">$</span>tipo)</a>
<a class="sourceLine" id="cb8-69" data-line-number="69">    </a>
<a class="sourceLine" id="cb8-70" data-line-number="70">    bdTemp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">codigoSessao =</span> <span class="kw">rep</span>(codigoSessao, <span class="kw">length</span>(nomeOrador)),</a>
<a class="sourceLine" id="cb8-71" data-line-number="71">                         <span class="dt">dataSessao =</span> <span class="kw">rep</span>(dataSessao, <span class="kw">length</span>(nomeOrador)),</a>
<a class="sourceLine" id="cb8-72" data-line-number="72">                         <span class="dt">numSessao =</span> <span class="kw">rep</span>(numSessao, <span class="kw">length</span>(nomeOrador)),</a>
<a class="sourceLine" id="cb8-73" data-line-number="73">                         <span class="dt">tipoSessao =</span> <span class="kw">rep</span>(tipoSessao, <span class="kw">length</span>(nomeOrador)),</a>
<a class="sourceLine" id="cb8-74" data-line-number="74">                         <span class="dt">codigoFase =</span> <span class="kw">rep</span>(codigoFase, <span class="kw">length</span>(nomeOrador)),</a>
<a class="sourceLine" id="cb8-75" data-line-number="75">                         <span class="dt">descricaoFase =</span> <span class="kw">rep</span>(descricaoFase, <span class="kw">length</span>(nomeOrador)),</a>
<a class="sourceLine" id="cb8-76" data-line-number="76">                         <span class="dt">numInsercao =</span> numInsercao,</a>
<a class="sourceLine" id="cb8-77" data-line-number="77">                         <span class="dt">numQuarto =</span> numQuarto,</a>
<a class="sourceLine" id="cb8-78" data-line-number="78">                         <span class="dt">hora =</span> hora,</a>
<a class="sourceLine" id="cb8-79" data-line-number="79">                         <span class="dt">numOrador =</span> numOrador,</a>
<a class="sourceLine" id="cb8-80" data-line-number="80">                         <span class="dt">nomeOrador =</span> nomeOrador,</a>
<a class="sourceLine" id="cb8-81" data-line-number="81">                         <span class="dt">uf =</span> uf,</a>
<a class="sourceLine" id="cb8-82" data-line-number="82">                         <span class="dt">partido =</span> partido, </a>
<a class="sourceLine" id="cb8-83" data-line-number="83">                         <span class="dt">indexacao =</span> indexacao,</a>
<a class="sourceLine" id="cb8-84" data-line-number="84">                         <span class="dt">sumario =</span> sumario)</a>
<a class="sourceLine" id="cb8-85" data-line-number="85">    </a>
<a class="sourceLine" id="cb8-86" data-line-number="86">    bd &lt;-<span class="st"> </span><span class="kw">rbind</span>(bd, bdTemp)</a>
<a class="sourceLine" id="cb8-87" data-line-number="87">  }</a></code></pre></div>
<p>Com o objeto <code>bd</code> acima, concluímos a primeira subetapa e podemos seguir para a segunda.</p>
</div>
<div id="b-obter-o-conteúdo-dos-discursos-inteiror-teor." class="section level3">
<h3><span class="header-section-number">5.3.3</span> b) obter o conteúdo dos discursos (inteiror teor).**</h3>
<p>Importante ressaltar que essa etapa só é possível tendo realizado o método acima de <code>ListarDiscursosPlenário</code>, devido exigência do próprio WebService.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">bdDados &lt;-<span class="st"> </span>bd</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">bd &lt;-<span class="st"> </span><span class="kw">data.frame</span>()  <span class="co"># data frame que recebera os pronunciamentos</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(bdDados)[<span class="dv">1</span>]){</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    link &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;https://www.camara.leg.br/SitCamaraWS/SessoesReunioes.asmx/obterInteiroTeorDiscursosPlenario?&quot;</span>,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                  <span class="st">&quot;codSessao=&quot;</span>, bdDados<span class="op">$</span>codigoSessao[i],</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">                  <span class="st">&quot;&amp;numOrador=&quot;</span>, bdDados<span class="op">$</span>numOrador[i], </a>
<a class="sourceLine" id="cb9-9" data-line-number="9">                  <span class="st">&quot;&amp;numQuarto=&quot;</span>, bdDados<span class="op">$</span>numQuarto[i],</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">                  <span class="st">&quot;&amp;numInsercao=&quot;</span>, bdDados<span class="op">$</span>numInsercao[i],</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">                  <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    <span class="kw">print</span>(link)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">    response &lt;-<span class="st"> </span><span class="kw">GET</span>(link)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">    data &lt;-<span class="st"> </span><span class="kw">xmlParse</span>(response, <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">    ls &lt;-<span class="st"> </span><span class="kw">xmlToList</span>(data)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">    </a>
<a class="sourceLine" id="cb9-17" data-line-number="17">    bdTemp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">nome =</span> ls<span class="op">$</span>nome,</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">                         <span class="dt">partido =</span> ls<span class="op">$</span>partido,</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">                         <span class="dt">uf =</span> ls<span class="op">$</span>uf,</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">                         <span class="dt">horaInicioDiscurso =</span> ls<span class="op">$</span>horaInicioDiscurso,</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">                         <span class="dt">discursoRTFBase64 =</span> ls<span class="op">$</span>discursoRTFBase64)</a>
<a class="sourceLine" id="cb9-22" data-line-number="22">    bd &lt;-<span class="st"> </span><span class="kw">rbind</span>(bd, bdTemp)</a>
<a class="sourceLine" id="cb9-23" data-line-number="23">    <span class="kw">Sys.sleep</span>(.<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb9-24" data-line-number="24">  }</a></code></pre></div>
<p>Obtivemos os discursos em seu inteiro teor! No entanto, os dados estão em formato
RTF codificado em Base64. Precisamos transformá-los em formato de texto plano para
possibilitar sua leitura:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">bd<span class="op">$</span>discursoRTFBase64 &lt;-<span class="st"> </span><span class="kw">as.character</span>(bd<span class="op">$</span>discursoRTFBase64)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">bd<span class="op">$</span>discursoPlainTxt &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode =</span> <span class="st">&quot;character&quot;</span>, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                                           <span class="dt">length =</span> <span class="kw">dim</span>(bd)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(bd)[<span class="dv">1</span>]){</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  bd<span class="op">$</span>discursoPlainTxt[i] &lt;-<span class="st"> </span><span class="kw">decode_rtf</span>(bd<span class="op">$</span>discursoRTFBase64[i])</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">  <span class="kw">print</span>( bd<span class="op">$</span>discursoPlainTxt)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">}</a></code></pre></div>
<div id="atividade-prática-1" class="section level4">
<h4><span class="header-section-number">5.3.3.1</span> Atividade prática</h4>
<p>Utilizando o código acima, obtenha as falas proferidas do dia da autorização do
processo de impeachement da Presidenta Dilma Vana Rousseff na Câmara dos Deputados,
ocorrido em 17 de abril de 2016. Salve os dados em formato <code>.rda</code>.</p>
</div>
</div>
</div>
<div id="download-de-arquivos-da-web" class="section level2">
<h2><span class="header-section-number">5.4</span> Download de arquivos da web</h2>
<p>Além do conteúdo diretamente publicado numa página web, pode ser de interesse
fazer o download de arquivos disponíveis. Em especial, no caso brasileiro, muitos
órgãos públicos publicam relatórios em formato <code>.pdf</code>. O obstáculo proporcionado
pelo formato do arquivo e o modo como o conteúdo é disponibilizado pode ser superado
com o uso da linguagem <code>R</code>.</p>
<p>Como exemplo, vamos conferir o caso do <a href="https://www.tce.pe.gov.br/internet/">Tribunal de Contas do Estado de Pernambuco</a>,
que anualmente disponibiliza relatórios de gestão.</p>
<center>
<div class="figure">
<img src="images/tce.png" alt="TCE-PE" width="700" />
<p class="caption">TCE-PE</p>
</div>
</center>
<p>Para atingir nosso objetivo, vamos utilizar as Etapas anteriormente apresentadas:</p>
<p><strong>Etapa 1: Conhecer detalhadamente o caminho para acesso aos dados:</strong></p>
<p>A <a href="%22https://www.tce.pe.gov.br/internet/index.php/relatorios-de-gestao-fiscal-2%22">página do TCE-PE</a> apresenta os relatórios publicados anualmente.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(rvest)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">library</span>(XML)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">library</span>(xml2)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">link_tce &lt;-<span class="st"> &quot;https://www.tce.pe.gov.br/internet/index.php/relatorios-de-gestao-fiscal-2&quot;</span></a></code></pre></div>
<p><strong>Etapa 2: Armazenar todos os caminhos de acesso aos dados de forma amigável ao programa:</strong></p>
<p>Aqui selecionamos exatamente os endereços de download de cada um dos arquivos publicados.
Todos os <code>.pdf</code> são um link dentro do código fonte da página, iremos, portanto, obter os
links desses relatórios.</p>
<p>Para tanto, podemos observar que o código fonte possui um padrão que identifica os
Relatórios de Desempenho anual: <code>rdg</code>. Iremos utilizá-lo para obter somente os documentos
que possuam esse padrão.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">link_relatorios &lt;-<span class="st"> </span>link_tce <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span>read_html <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># função que irá ler o código fonte escrito em html</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># nó presente no código fonte antes do pdf</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>) <span class="co"># atributro do nó</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co"># obtenção dos links do relatório através do padrão `rgd`</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">link_relatorios &lt;-<span class="st"> </span>link_relatorios[<span class="kw">grep</span>(<span class="st">&quot;rdg&quot;</span>, link_relatorios)] </a></code></pre></div>
<p><strong>Etapa 3: Obter os dados:</strong></p>
<p>A obtenção dos dados se refere justamente ao download do material para armazenamento
local. Logo, definimos o diretório onde os arquivos serão salvos e fazemos uso da
função <code>download.file</code>. Como obtivemos mais de um link, para mais de um relatório,
no código abaixo apresentamos como obter o primeiro arquivo <code>.pdf</code> presente em <code>link_relatorios[1]</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">download.file</span>(link_relatorios[<span class="dv">1</span>], <span class="dt">destfile =</span> <span class="st">&quot;seu_diretorio/nome_do_arquivo.pdf&quot;</span>, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)</a></code></pre></div>
<p><strong>Etapa 4: Processar os dados obtidos:</strong></p>
<p>O processo é similar à leitura de conteúdo em arquivo <code>.pdf</code> explicada na seção <a href="scrape.html#pdf"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># pacotes</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">library</span>(textreadr)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co"># # lendo arquivo .pdf</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">rdg2018 &lt;-<span class="st"> </span><span class="kw">read_document</span>(<span class="st">&quot;nome_arquivo.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co"># salvando como .txt</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="kw">writeLines</span>(rdg2018, <span class="st">&quot;meu_arquivo.txt&quot;</span>)</a></code></pre></div>
</div>
<div id="twitter" class="section level2">
<h2><span class="header-section-number">5.5</span> Twitter</h2>
<p>Existem diversos pacotes que possibilitam a captura de informação do Twitter, sendo
possível obter tweets ou timelines somente de usuários públicos, ou seja que não possuem
um perfil privado. Como exemplo, vamos utilizar o pacote <a href="https://github.com/ropensci/rtweet"><code>rtweet</code></a>
para obter dados dos tweets da timeline da <a href="https://www.camara.leg.br/deputados/204534">Deputada Federal Tabata Amaral</a>.
Vale ressaltar que o Twitter exige que para obtenção dos dados você possua uma conta
no Twitter e autorize o app <code>rstats2twitter</code> no popup que surgirá no seu browser
ao utilizar alguma das funções no console do <code>R</code>, isso ocorrerá somente na primeira
vez de uso, criando um token que será salvo para próximas sessões.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(rtweet)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">tabata_timeline &lt;-<span class="st"> </span><span class="kw">get_timeline</span>( <span class="dt">user =</span> <span class="st">&quot;tabataamaralsp&quot;</span>, <span class="dt">n =</span> <span class="dv">30</span>)</a></code></pre></div>
<p>Além do uso de obtenção de hashtags é possível buscar termos que estão sendo tweetados
ou hashtags através do <code>search_tweets</code> que segue lógica similar ao <code>get_timeline</code>.</p>
</div>
<div id="imagens" class="section level2">
<h2><span class="header-section-number">5.6</span> Imagens</h2>
<p>No caso de textos em imagem é possível utilizar o <em>optical character recognition</em> (OCR). OCR
é o processo de encontrar e reconhecer texto dentro de imagens, por exemplo, de uma captura
de tela, texto digitalizado, etc. A imagem abaixo tem um texto de exemplo:</p>
<center>
<div class="figure">
<img src="images/testocr.png" alt="ocr" width="400" />
<p class="caption">ocr</p>
</div>
</center>
<p>Com o pacote <a href="https://cran.r-project.org/web/packages/tesseract/vignettes/intro.html"><code>Tesseract</code></a> e
o uso da <a href="https://cloud.google.com/vision/">Interface de Programação de Aplicativos (API) do Google</a> é
possível capturar seu conteúdo, podendo ser uma imagem presente no seu computador ou da
web. Para realizá-lo em português é necessário instalar o acervo de treinamento em português
com o seguinte comando <code>tesseract_download('por')</code>. No caso, vamos utilizar a imagem do Tweet Fake
atribuído ao Presidente Bolsonaro para obter seu conteúdo:</p>
<center>
<div class="figure">
<img src="images/tweet_bolsonaro_cp.png" alt="FAKE NEWS!" width="400" />
<p class="caption">FAKE NEWS!</p>
</div>
</center>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">library</span>(tesseract)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># obtendo treinamento na ligua portuguesa</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw">tesseract_download</span>(<span class="st">&#39;por&#39;</span>)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">por &lt;-<span class="st"> </span><span class="kw">tesseract</span>(<span class="st">&quot;por&quot;</span>) <span class="co"># alocando treinamento na ligua portuguesa</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co"># obtendo texto da imagem</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">text &lt;-<span class="st"> </span>tesseract<span class="op">::</span><span class="kw">ocr</span>(<span class="st">&quot;https://raw.githubusercontent.com/davi-moreira/txt4cs/master/images/tweet_bolsonaro_cp.png&quot;</span>, <span class="dt">engine =</span> por)</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co"># resultado</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="kw">cat</span>(text)</a></code></pre></div>
<pre><code>## Jair M. Bolsonaro &amp; 8
## a Qjairbolsonaro Vie
## . S
## O que é ciência política?
## 09:26 - 06/03/2019 - Twitter for iPhone</code></pre>
</div>
<div id="áudio-transcrição" class="section level2">
<h2><span class="header-section-number">5.7</span> Áudio Transcrição</h2>
<p>EM CONSTRUÇÃO………..</p>
<!---
* consegui o pacote e API do google cloud, mas estou tendo problema no audio mp3
> som <- gl_speech("dilma-defesa.mp3", encoding = "LINEAR16",languageCode = "pt-BR")
i 2020-08-27 15:51:43 > Request Status Code:  400
Erro: API returned: Specify MP3 encoding to match audio file.

O transcribeR o API não está funcionando mais, não é possível usar então o pacote.

Amazon não consigo fazer a chave funcionar!


Nos últimos anos, diversas aplicações comerciais passaram a ofertar a possibilidade de transcrição de áudios e vídeos. Acompanhando esse processo, iniciativas foram implementadas na liguagem `R`. Abaixo são apresentadas três delas. De forma geral, utilizam APIs de grandes companhias de tecnologia com alguma limitação para uso gratuito:

- Pacote [`googleLanguageR`](https://cran.r-project.org/web/packages/googleLanguageR/index.html): Permite o uso de diferentes ferramentas de aprendizagem computacional do Google ([Tutorial](https://cran.r-project.org/web/packages/googleLanguageR/vignettes/setup.html)). No caso de transcrição a API recomendada é a [Google Could Speech API](https://cran.r-project.org/web/packages/googleLanguageR/vignettes/speech.html).

- Pacote [`transcribeR`](https://cran.r-project.org/web/packages/transcribeR/index.html): a transcrição é feita com o uso do HP IDOL API [Tutorial](https://cran.r-project.org/web/packages/transcribeR/vignettes/Transcribing_audio_with_transcribeR.html#introduction)). 

- Pacote [`aws.transcribe`](https://cran.r-project.org/web/packages/aws.transcribe/index.html): nesse caso a transcrição é feita com o uso do AWS API da Amazon [README](https://cran.r-project.org/web/packages/aws.transcribe/README.html), [Git do projeto](https://github.com/cloudyr/aws.transcribe)). 

Sys.setenv("AWS_ACCESS_KEY_ID" = "AKIAJ6ZJ5UB2SIOZNC3A",
           "AWS_SECRET_ACCESS_KEY" = "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",
           "AWS_DEFAULT_REGION" = "",
           "AWS_SESSION_TOKEN" = "mytoken")
--->

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Conteúdo publicado sem revisão do autor.<a href="scrape.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Conteúdo publicado sem revisão do autor.<a href="scrape.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>Para uma referência de como transformar objetos <code>xml</code> em <code>data.frame</code> ver: i) (<a href="https://stackoverflow.com/questions/17198658/how-to-parse-xml-to-r-data-frame" class="uri">https://stackoverflow.com/questions/17198658/how-to-parse-xml-to-r-data-frame</a>); ii) (<a href="https://stackoverflow.com/questions/13579996/how-to-create-an-r-data-frame-from-a-xml-file" class="uri">https://stackoverflow.com/questions/13579996/how-to-create-an-r-data-frame-from-a-xml-file</a>)<a href="scrape.html#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stringR.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="processamento.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["txt4cs.gitbook", "txt4cs.pdf", "txt4cs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
